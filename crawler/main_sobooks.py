#!/usr/bin/env python 
#  -*- coding: utf-8 -*-

'''
+-------------------------------------------------
@Author:        cc
@Contact:       yaochen@xjh.com
@Site:          http://www.xjh.com
@Project:       sobookscrawler
@File:          main_sobooks.py
@Version:       
@Time:          2019/5/22 11:35
@Description:   TO-DO
+-------------------------------------------------
@Change Activity:
1.  Created at  2019/5/22 11:35
2.  TO-DO
+-------------------------------------------------
'''
__author__ = 'cc'

import os
from datetime import datetime

import click

from crawler.services.baidu_yun_service import BaiduYunService
from crawler.services.sobooks_crawler_service import SobooksCrawlerExecutor
from website.utils import path_util

# Status files
MONGO_CFG_PATH = os.path.join(path_util.get_app_path(), 'resources', 'configs', 'database.cfg.py')

SINCE_DATE_PATH = os.path.join(path_util.get_app_path(), '..', 'bin', 'since-date.json')


def fetch_from_sobooks_site(since_date):
	urls = [
		'https://sobooks.cc/books/12965.html'
		, 'https://sobooks.cc/books/12929.html'
		, 'https://sobooks.cc/books/12926.html'
		, 'https://sobooks.cc/books/12923.html'
		, 'https://sobooks.cc/books/12916.html'
		, 'https://sobooks.cc/books/12912.html'
		, 'https://sobooks.cc/books/12910.html'
		, 'https://sobooks.cc/books/12899.html'
		, 'https://sobooks.cc/books/12894.html'
		, 'https://sobooks.cc/books/12888.html'
		, 'https://sobooks.cc/books/12879.html'
		, 'https://sobooks.cc/books/12864.html'
		, 'https://sobooks.cc/books/12873.html'
		, 'https://sobooks.cc/books/12799.html'
		, 'https://sobooks.cc/books/12769.html'
		, 'https://sobooks.cc/books/12746.html'
		, 'https://sobooks.cc/books/12737.html'
		, 'https://sobooks.cc/books/12646.html'
		, 'https://sobooks.cc/books/12566.html'
		, 'https://sobooks.cc/books/12542.html'
		, 'https://sobooks.cc/books/12526.html'
		, 'https://sobooks.cc/books/12505.html'
		, 'https://sobooks.cc/books/12481.html'
		, 'https://sobooks.cc/books/12480.html'
		, 'https://sobooks.cc/books/12913.html'
		, 'https://sobooks.cc/books/12908.html'
		, 'https://sobooks.cc/books/12902.html'
		, 'https://sobooks.cc/books/12897.html'
		, 'https://sobooks.cc/books/12892.html'
		, 'https://sobooks.cc/books/12890.html'
		, 'https://sobooks.cc/books/12834.html'
		, 'https://sobooks.cc/books/12810.html'
		, 'https://sobooks.cc/books/12779.html'
		, 'https://sobooks.cc/books/12764.html'
		, 'https://sobooks.cc/books/12736.html'
		, 'https://sobooks.cc/books/12698.html'
		, 'https://sobooks.cc/books/12691.html'
		, 'https://sobooks.cc/books/12667.html'
		, 'https://sobooks.cc/books/12653.html'
		, 'https://sobooks.cc/books/12648.html'
		, 'https://sobooks.cc/books/12637.html'
		, 'https://sobooks.cc/books/12581.html'
		, 'https://sobooks.cc/books/12541.html'
		, 'https://sobooks.cc/books/12528.html'
		, 'https://sobooks.cc/books/12514.html'
		, 'https://sobooks.cc/books/12513.html'
		, 'https://sobooks.cc/books/12498.html'
		, 'https://sobooks.cc/books/12486.html'
		, 'https://sobooks.cc/books/12939.html'
		, 'https://sobooks.cc/books/12974.html'
		, 'https://sobooks.cc/books/12968.html'
		, 'https://sobooks.cc/books/12963.html'
		, 'https://sobooks.cc/books/12887.html'
		, 'https://sobooks.cc/books/12882.html'
		, 'https://sobooks.cc/books/12876.html'
		, 'https://sobooks.cc/books/12860.html'
		, 'https://sobooks.cc/books/12850.html'
		, 'https://sobooks.cc/books/12766.html'
		, 'https://sobooks.cc/books/12759.html'
		, 'https://sobooks.cc/books/12750.html'
		, 'https://sobooks.cc/books/12747.html'
		, 'https://sobooks.cc/books/12739.html'
		, 'https://sobooks.cc/books/12727.html'
		, 'https://sobooks.cc/books/12724.html'
		, 'https://sobooks.cc/books/12692.html'
		, 'https://sobooks.cc/books/12640.html'
		, 'https://sobooks.cc/books/12612.html'
		, 'https://sobooks.cc/books/12607.html'
		, 'https://sobooks.cc/books/12594.html'
		, 'https://sobooks.cc/books/12928.html'
		, 'https://sobooks.cc/books/12911.html'
		, 'https://sobooks.cc/books/12596.html'
		, 'https://sobooks.cc/books/12900.html'
		, 'https://sobooks.cc/books/12885.html'
		, 'https://sobooks.cc/books/12569.html'
		, 'https://sobooks.cc/books/12884.html'
		, 'https://sobooks.cc/books/12867.html'
		, 'https://sobooks.cc/books/12540.html'
		, 'https://sobooks.cc/books/12859.html'
		, 'https://sobooks.cc/books/12856.html'
		, 'https://sobooks.cc/books/12853.html'
		, 'https://sobooks.cc/books/12849.html'
		, 'https://sobooks.cc/books/12517.html'
		, 'https://sobooks.cc/books/12817.html'
		, 'https://sobooks.cc/books/12783.html'
		, 'https://sobooks.cc/books/12778.html'
		, 'https://sobooks.cc/books/12506.html'
		, 'https://sobooks.cc/books/12504.html'
		, 'https://sobooks.cc/books/12497.html'
		, 'https://sobooks.cc/books/12718.html'
		, 'https://sobooks.cc/books/12695.html'
		, 'https://sobooks.cc/books/12686.html'
		, 'https://sobooks.cc/books/12676.html'
		, 'https://sobooks.cc/books/12675.html'
		, 'https://sobooks.cc/books/12645.html'
		, 'https://sobooks.cc/books/12629.html'
		, 'https://sobooks.cc/books/12627.html'
		, 'https://sobooks.cc/books/12602.html'
		, 'https://sobooks.cc/books/12593.html'
		, 'https://sobooks.cc/books/12567.html'
		, 'https://sobooks.cc/books/12512.html'
		, 'https://sobooks.cc/books/12970.html'
		, 'https://sobooks.cc/books/12964.html'
		, 'https://sobooks.cc/books/12949.html'
		, 'https://sobooks.cc/books/12904.html'
		, 'https://sobooks.cc/books/12896.html'
		, 'https://sobooks.cc/books/12878.html'
		, 'https://sobooks.cc/books/12863.html'
		, 'https://sobooks.cc/books/12842.html'
		, 'https://sobooks.cc/books/12812.html'
		, 'https://sobooks.cc/books/12786.html'
		, 'https://sobooks.cc/books/12763.html'
		, 'https://sobooks.cc/books/12753.html'
		, 'https://sobooks.cc/books/12745.html'
		, 'https://sobooks.cc/books/12713.html'
		, 'https://sobooks.cc/books/12705.html'
		, 'https://sobooks.cc/books/12694.html'
		, 'https://sobooks.cc/books/12669.html'
		, 'https://sobooks.cc/books/12613.html'
		, 'https://sobooks.cc/books/12560.html'
		, 'https://sobooks.cc/books/12558.html'
		, 'https://sobooks.cc/books/12489.html'
		, 'https://sobooks.cc/books/12479.html'
		, 'https://sobooks.cc/books/12954.html'
		, 'https://sobooks.cc/books/12921.html'
		, 'https://sobooks.cc/books/12886.html'
		, 'https://sobooks.cc/books/12862.html'
		, 'https://sobooks.cc/books/12858.html'
		, 'https://sobooks.cc/books/12800.html'
		, 'https://sobooks.cc/books/12756.html'
		, 'https://sobooks.cc/books/12751.html'
		, 'https://sobooks.cc/books/12723.html'
		, 'https://sobooks.cc/books/12693.html'
		, 'https://sobooks.cc/books/12663.html'
		, 'https://sobooks.cc/books/12642.html'
		, 'https://sobooks.cc/books/12638.html'
		, 'https://sobooks.cc/books/12625.html'
		, 'https://sobooks.cc/books/12586.html'
		, 'https://sobooks.cc/books/12551.html'
		, 'https://sobooks.cc/books/12544.html'
		, 'https://sobooks.cc/books/12538.html'
		, 'https://sobooks.cc/books/12471.html'
		, 'https://sobooks.cc/books/12973.html'
		, 'https://sobooks.cc/books/12946.html'
		, 'https://sobooks.cc/books/12938.html'
		, 'https://sobooks.cc/books/12881.html'
		, 'https://sobooks.cc/books/12861.html'
		, 'https://sobooks.cc/books/12857.html'
		, 'https://sobooks.cc/books/12852.html'
		, 'https://sobooks.cc/books/12851.html'
		, 'https://sobooks.cc/books/12828.html'
		, 'https://sobooks.cc/books/12819.html'
		, 'https://sobooks.cc/books/12816.html'
		, 'https://sobooks.cc/books/12814.html'
		, 'https://sobooks.cc/books/12811.html'
		, 'https://sobooks.cc/books/12774.html'
		, 'https://sobooks.cc/books/12777.html'
		, 'https://sobooks.cc/books/12776.html'
		, 'https://sobooks.cc/books/12757.html'
		, 'https://sobooks.cc/books/12734.html'
		, 'https://sobooks.cc/books/12716.html'
		, 'https://sobooks.cc/books/12690.html'
		, 'https://sobooks.cc/books/12684.html'
		, 'https://sobooks.cc/books/12683.html'
		, 'https://sobooks.cc/books/12681.html'
		, 'https://sobooks.cc/books/12666.html'
		, 'https://sobooks.cc/books/12654.html'
		, 'https://sobooks.cc/books/12652.html'
		, 'https://sobooks.cc/books/12616.html'
		, 'https://sobooks.cc/books/12609.html'
		, 'https://sobooks.cc/books/12591.html'
		, 'https://sobooks.cc/books/12571.html'
		, 'https://sobooks.cc/books/12537.html'
		, 'https://sobooks.cc/books/12523.html'
		, 'https://sobooks.cc/books/12510.html'
		, 'https://sobooks.cc/books/12490.html'
		, 'https://sobooks.cc/books/12936.html'
		, 'https://sobooks.cc/books/12937.html'
		, 'https://sobooks.cc/books/12917.html'
		, 'https://sobooks.cc/books/12901.html'
		, 'https://sobooks.cc/books/12866.html'
		, 'https://sobooks.cc/books/12848.html'
		, 'https://sobooks.cc/books/12841.html'
		, 'https://sobooks.cc/books/12802.html'
		, 'https://sobooks.cc/books/12781.html'
		, 'https://sobooks.cc/books/12775.html'
		, 'https://sobooks.cc/books/12740.html'
		, 'https://sobooks.cc/books/12728.html'
		, 'https://sobooks.cc/books/12687.html'
		, 'https://sobooks.cc/books/12679.html'
		, 'https://sobooks.cc/books/12670.html'
		, 'https://sobooks.cc/books/12650.html'
		, 'https://sobooks.cc/books/12626.html'
		, 'https://sobooks.cc/books/12619.html'
		, 'https://sobooks.cc/books/12614.html'
		, 'https://sobooks.cc/books/12598.html'
		, 'https://sobooks.cc/books/12595.html'
		, 'https://sobooks.cc/books/12574.html'
		, 'https://sobooks.cc/books/12562.html'
		, 'https://sobooks.cc/books/12545.html'
		, 'https://sobooks.cc/books/12543.html'
		, 'https://sobooks.cc/books/12515.html'
		, 'https://sobooks.cc/books/12503.html'
		, 'https://sobooks.cc/books/12507.html'
		, 'https://sobooks.cc/books/12971.html'
		, 'https://sobooks.cc/books/12967.html'
		, 'https://sobooks.cc/books/12948.html'
		, 'https://sobooks.cc/books/12944.html'
		, 'https://sobooks.cc/books/12932.html'
		, 'https://sobooks.cc/books/12907.html'
		, 'https://sobooks.cc/books/12868.html'
		, 'https://sobooks.cc/books/12847.html'
		, 'https://sobooks.cc/books/12832.html'
		, 'https://sobooks.cc/books/12806.html'
		, 'https://sobooks.cc/books/12762.html'
		, 'https://sobooks.cc/books/12758.html'
		, 'https://sobooks.cc/books/12741.html'
		, 'https://sobooks.cc/books/12731.html'
		, 'https://sobooks.cc/books/12726.html'
		, 'https://sobooks.cc/books/12696.html'
		, 'https://sobooks.cc/books/12678.html'
		, 'https://sobooks.cc/books/12658.html'
		, 'https://sobooks.cc/books/12635.html'
		, 'https://sobooks.cc/books/12608.html'
		, 'https://sobooks.cc/books/12568.html'
		, 'https://sobooks.cc/books/12565.html'
		, 'https://sobooks.cc/books/12552.html'
		, 'https://sobooks.cc/books/12547.html'
		, 'https://sobooks.cc/books/12546.html'
		, 'https://sobooks.cc/books/12539.html'
		, 'https://sobooks.cc/books/12521.html'
		, 'https://sobooks.cc/books/12473.html'
		, 'https://sobooks.cc/books/12962.html'
		, 'https://sobooks.cc/books/12969.html'
		, 'https://sobooks.cc/books/12972.html'
		, 'https://sobooks.cc/books/12957.html'
		, 'https://sobooks.cc/books/12947.html'
		, 'https://sobooks.cc/books/12872.html'
		, 'https://sobooks.cc/books/12843.html'
		, 'https://sobooks.cc/books/12833.html'
		, 'https://sobooks.cc/books/12830.html'
		, 'https://sobooks.cc/books/12796.html'
		, 'https://sobooks.cc/books/12793.html'
		, 'https://sobooks.cc/books/12767.html'
		, 'https://sobooks.cc/books/12732.html'
		, 'https://sobooks.cc/books/12715.html'
		, 'https://sobooks.cc/books/12707.html'
		, 'https://sobooks.cc/books/12659.html'
		, 'https://sobooks.cc/books/12636.html'
		, 'https://sobooks.cc/books/12628.html'
		, 'https://sobooks.cc/books/12532.html'
		, 'https://sobooks.cc/books/12531.html'
		, 'https://sobooks.cc/books/12500.html'
		, 'https://sobooks.cc/books/12478.html'
		, 'https://sobooks.cc/books/12482.html'
		, 'https://sobooks.cc/books/12975.html'
		, 'https://sobooks.cc/books/12448.html'
		, 'https://sobooks.cc/books/12455.html'
		, 'https://sobooks.cc/books/12459.html'
		, 'https://sobooks.cc/books/12439.html'
		, 'https://sobooks.cc/books/12441.html'
		, 'https://sobooks.cc/books/12427.html'
		, 'https://sobooks.cc/books/12422.html'
		, 'https://sobooks.cc/books/13086.html'
		, 'https://sobooks.cc/books/13084.html'
		, 'https://sobooks.cc/books/13057.html'
		, 'https://sobooks.cc/books/13035.html'
		, 'https://sobooks.cc/books/13031.html'
		, 'https://sobooks.cc/books/13024.html'
		, 'https://sobooks.cc/books/13013.html'
		, 'https://sobooks.cc/books/13001.html'
		, 'https://sobooks.cc/books/12982.html'
		, 'https://sobooks.cc/books/12981.html'
		, 'https://sobooks.cc/books/13146.html'
		, 'https://sobooks.cc/books/13139.html'
		, 'https://sobooks.cc/books/13133.html'
		, 'https://sobooks.cc/books/13127.html'
		, 'https://sobooks.cc/books/13126.html'
		, 'https://sobooks.cc/books/13103.html'
		, 'https://sobooks.cc/books/13099.html'
		, 'https://sobooks.cc/books/12423.html'
		, 'https://sobooks.cc/books/12436.html'
		, 'https://sobooks.cc/books/13066.html'
		, 'https://sobooks.cc/books/13029.html'
		, 'https://sobooks.cc/books/13023.html'
		, 'https://sobooks.cc/books/13019.html'
		, 'https://sobooks.cc/books/13017.html'
		, 'https://sobooks.cc/books/13003.html'
		, 'https://sobooks.cc/books/13177.html'
		, 'https://sobooks.cc/books/13167.html'
		, 'https://sobooks.cc/books/13144.html'
		, 'https://sobooks.cc/books/13138.html'
		, 'https://sobooks.cc/books/13121.html'
		, 'https://sobooks.cc/books/13114.html'
		, 'https://sobooks.cc/books/13090.html'
		, 'https://sobooks.cc/books/13072.html'
		, 'https://sobooks.cc/books/13068.html'
		, 'https://sobooks.cc/books/13028.html'
		, 'https://sobooks.cc/books/12999.html'
		, 'https://sobooks.cc/books/12988.html'
		, 'https://sobooks.cc/books/13153.html'
		, 'https://sobooks.cc/books/13134.html'
		, 'https://sobooks.cc/books/13122.html'
		, 'https://sobooks.cc/books/13108.html'
		, 'https://sobooks.cc/books/13106.html'
		, 'https://sobooks.cc/books/12437.html'
		, 'https://sobooks.cc/books/12426.html'
		, 'https://sobooks.cc/books/13087.html'
		, 'https://sobooks.cc/books/13065.html'
		, 'https://sobooks.cc/books/13021.html'
		, 'https://sobooks.cc/books/12985.html'
		, 'https://sobooks.cc/books/12979.html'
		, 'https://sobooks.cc/books/12976.html'
		, 'https://sobooks.cc/books/13150.html'
		, 'https://sobooks.cc/books/13147.html'
		, 'https://sobooks.cc/books/13120.html'
		, 'https://sobooks.cc/books/13100.html'
		, 'https://sobooks.cc/books/12466.html'
		, 'https://sobooks.cc/books/12461.html'
		, 'https://sobooks.cc/books/12465.html'
		, 'https://sobooks.cc/books/12434.html'
		, 'https://sobooks.cc/books/13089.html'
		, 'https://sobooks.cc/books/13083.html'
		, 'https://sobooks.cc/books/13077.html'
		, 'https://sobooks.cc/books/13047.html'
		, 'https://sobooks.cc/books/13042.html'
		, 'https://sobooks.cc/books/13025.html'
		, 'https://sobooks.cc/books/13006.html'
		, 'https://sobooks.cc/books/12991.html'
		, 'https://sobooks.cc/books/13169.html'
		, 'https://sobooks.cc/books/13163.html'
		, 'https://sobooks.cc/books/13141.html'
		, 'https://sobooks.cc/books/13129.html'
		, 'https://sobooks.cc/books/13102.html'
		, 'https://sobooks.cc/books/12469.html'
		, 'https://sobooks.cc/books/12454.html'
		, 'https://sobooks.cc/books/12438.html'
		, 'https://sobooks.cc/books/12421.html'
		, 'https://sobooks.cc/books/12432.html'
		, 'https://sobooks.cc/books/13062.html'
		, 'https://sobooks.cc/books/13048.html'
		, 'https://sobooks.cc/books/13022.html'
		, 'https://sobooks.cc/books/13010.html'
		, 'https://sobooks.cc/books/12978.html'
		, 'https://sobooks.cc/books/13178.html'
		, 'https://sobooks.cc/books/13164.html'
		, 'https://sobooks.cc/books/13140.html'
		, 'https://sobooks.cc/books/13135.html'
		, 'https://sobooks.cc/books/13128.html'
		, 'https://sobooks.cc/books/13123.html'
		, 'https://sobooks.cc/books/13115.html'
		, 'https://sobooks.cc/books/12462.html'
		, 'https://sobooks.cc/books/12452.html'
		, 'https://sobooks.cc/books/12443.html'
		, 'https://sobooks.cc/books/12444.html'
		, 'https://sobooks.cc/books/12424.html'
		, 'https://sobooks.cc/books/13092.html'
		, 'https://sobooks.cc/books/13076.html'
		, 'https://sobooks.cc/books/13039.html'
		, 'https://sobooks.cc/books/13026.html'
		, 'https://sobooks.cc/books/13005.html'
		, 'https://sobooks.cc/books/12994.html'
		, 'https://sobooks.cc/books/13181.html'
		, 'https://sobooks.cc/books/13172.html'
		, 'https://sobooks.cc/books/13160.html'
		, 'https://sobooks.cc/books/13152.html'
		, 'https://sobooks.cc/books/13145.html'
		, 'https://sobooks.cc/books/13130.html'
		, 'https://sobooks.cc/books/13107.html'
		, 'https://sobooks.cc/books/12463.html'
		, 'https://sobooks.cc/books/12450.html'
		, 'https://sobooks.cc/books/12447.html'
		, 'https://sobooks.cc/books/12435.html'
		, 'https://sobooks.cc/books/13088.html'
		, 'https://sobooks.cc/books/13069.html'
		, 'https://sobooks.cc/books/13050.html'
		, 'https://sobooks.cc/books/13049.html'
		, 'https://sobooks.cc/books/13007.html'
		, 'https://sobooks.cc/books/12998.html'
		, 'https://sobooks.cc/books/12989.html'
		, 'https://sobooks.cc/books/12984.html'
		, 'https://sobooks.cc/books/13161.html'
		, 'https://sobooks.cc/books/13142.html'
		, 'https://sobooks.cc/books/13132.html'
		, 'https://sobooks.cc/books/13125.html'
		, 'https://sobooks.cc/books/13119.html'
		, 'https://sobooks.cc/books/13109.html'
		, 'https://sobooks.cc/books/13097.html'
		, 'https://sobooks.cc/books/12456.html'
		, 'https://sobooks.cc/books/12445.html'
		, 'https://sobooks.cc/books/12419.html'
		, 'https://sobooks.cc/books/13061.html'
		, 'https://sobooks.cc/books/13038.html'
		, 'https://sobooks.cc/books/13037.html'
		, 'https://sobooks.cc/books/13016.html'
		, 'https://sobooks.cc/books/13168.html'
		, 'https://sobooks.cc/books/13162.html'
		, 'https://sobooks.cc/books/13159.html'
		, 'https://sobooks.cc/books/13143.html'
		, 'https://sobooks.cc/books/12472.html'
		, 'https://sobooks.cc/books/12451.html'
		, 'https://sobooks.cc/books/12425.html'
		, 'https://sobooks.cc/books/12418.html'
		, 'https://sobooks.cc/books/13045.html'
		, 'https://sobooks.cc/books/13043.html'
		, 'https://sobooks.cc/books/13020.html'
		, 'https://sobooks.cc/books/12987.html'
		, 'https://sobooks.cc/books/12980.html'
		, 'https://sobooks.cc/books/13176.html'
		, 'https://sobooks.cc/books/13148.html'
		, 'https://sobooks.cc/books/13104.html'
		, 'https://sobooks.cc/books/13101.html'
		, 'https://sobooks.cc/books/12966.html'
		, 'https://sobooks.cc/books/12958.html'
		, 'https://sobooks.cc/books/12956.html'
		, 'https://sobooks.cc/books/12959.html'
		, 'https://sobooks.cc/books/12925.html'
		, 'https://sobooks.cc/books/12920.html'
		, 'https://sobooks.cc/books/12918.html'
		, 'https://sobooks.cc/books/12895.html'
		, 'https://sobooks.cc/books/12889.html'
		, 'https://sobooks.cc/books/12875.html'
		, 'https://sobooks.cc/books/12870.html'
		, 'https://sobooks.cc/books/12827.html'
		, 'https://sobooks.cc/books/12818.html'
		, 'https://sobooks.cc/books/12813.html'
		, 'https://sobooks.cc/books/12798.html'
		, 'https://sobooks.cc/books/12780.html'
		, 'https://sobooks.cc/books/12725.html'
		, 'https://sobooks.cc/books/12674.html'
		, 'https://sobooks.cc/books/12672.html'
		, 'https://sobooks.cc/books/12665.html'
		, 'https://sobooks.cc/books/12634.html'
		, 'https://sobooks.cc/books/12624.html'
		, 'https://sobooks.cc/books/12622.html'
		, 'https://sobooks.cc/books/12621.html'
		, 'https://sobooks.cc/books/12617.html'
		, 'https://sobooks.cc/books/12615.html'
		, 'https://sobooks.cc/books/12606.html'
		, 'https://sobooks.cc/books/12605.html'
		, 'https://sobooks.cc/books/12604.html'
		, 'https://sobooks.cc/books/12601.html'
		, 'https://sobooks.cc/books/12553.html'
		, 'https://sobooks.cc/books/12548.html'
		, 'https://sobooks.cc/books/12524.html'
		, 'https://sobooks.cc/books/12520.html'
		, 'https://sobooks.cc/books/12519.html'
		, 'https://sobooks.cc/books/12516.html'
		, 'https://sobooks.cc/books/12492.html'
		, 'https://sobooks.cc/books/12488.html'
		, 'https://sobooks.cc/books/12483.html'
		, 'https://sobooks.cc/books/12477.html'
		, 'https://sobooks.cc/books/12467.html'
		, 'https://sobooks.cc/books/13093.html'
		, 'https://sobooks.cc/books/13091.html'
		, 'https://sobooks.cc/books/13044.html'
		, 'https://sobooks.cc/books/13040.html'
		, 'https://sobooks.cc/books/13036.html'
		, 'https://sobooks.cc/books/13033.html'
		, 'https://sobooks.cc/books/13002.html'
		, 'https://sobooks.cc/books/13158.html'
		, 'https://sobooks.cc/books/13111.html'
		, 'https://sobooks.cc/books/12952.html'
		, 'https://sobooks.cc/books/12941.html'
		, 'https://sobooks.cc/books/12935.html'
		, 'https://sobooks.cc/books/12933.html'
		, 'https://sobooks.cc/books/12906.html'
		, 'https://sobooks.cc/books/12891.html'
		, 'https://sobooks.cc/books/12871.html'
		, 'https://sobooks.cc/books/12854.html'
		, 'https://sobooks.cc/books/12829.html'
		, 'https://sobooks.cc/books/12809.html'
		, 'https://sobooks.cc/books/12804.html'
		, 'https://sobooks.cc/books/12794.html'
		, 'https://sobooks.cc/books/12765.html'
		, 'https://sobooks.cc/books/12722.html'
		, 'https://sobooks.cc/books/12719.html'
		, 'https://sobooks.cc/books/12714.html'
		, 'https://sobooks.cc/books/12710.html'
		, 'https://sobooks.cc/books/12701.html'
		, 'https://sobooks.cc/books/12697.html'
		, 'https://sobooks.cc/books/12685.html'
		, 'https://sobooks.cc/books/12664.html'
		, 'https://sobooks.cc/books/12643.html'
		, 'https://sobooks.cc/books/12597.html'
		, 'https://sobooks.cc/books/12572.html'
		, 'https://sobooks.cc/books/12564.html'
		, 'https://sobooks.cc/books/12549.html'
		, 'https://sobooks.cc/books/12533.html'
		, 'https://sobooks.cc/books/12525.html'
		, 'https://sobooks.cc/books/12508.html'
		, 'https://sobooks.cc/books/12493.html'
		, 'https://sobooks.cc/books/12496.html'
		, 'https://sobooks.cc/books/12487.html'
		, 'https://sobooks.cc/books/12458.html'
		, 'https://sobooks.cc/books/12457.html'
		, 'https://sobooks.cc/books/12440.html'
		, 'https://sobooks.cc/books/12442.html'
		, 'https://sobooks.cc/books/12433.html'
		, 'https://sobooks.cc/books/12429.html'
		, 'https://sobooks.cc/books/13095.html'
		, 'https://sobooks.cc/books/13070.html'
		, 'https://sobooks.cc/books/13051.html'
		, 'https://sobooks.cc/books/13041.html'
		, 'https://sobooks.cc/books/13030.html'
		, 'https://sobooks.cc/books/13027.html'
		, 'https://sobooks.cc/books/13015.html'
		, 'https://sobooks.cc/books/13014.html'
		, 'https://sobooks.cc/books/12993.html'
		, 'https://sobooks.cc/books/12983.html'
		, 'https://sobooks.cc/books/13171.html'
		, 'https://sobooks.cc/books/13170.html'
		, 'https://sobooks.cc/books/13131.html'
		, 'https://sobooks.cc/books/13117.html'
		, 'https://sobooks.cc/books/13110.html'
		, 'https://sobooks.cc/books/12953.html'
		, 'https://sobooks.cc/books/12945.html'
		, 'https://sobooks.cc/books/12942.html'
		, 'https://sobooks.cc/books/12927.html'
		, 'https://sobooks.cc/books/12877.html'
		, 'https://sobooks.cc/books/12835.html'
		, 'https://sobooks.cc/books/12820.html'
		, 'https://sobooks.cc/books/12803.html'
		, 'https://sobooks.cc/books/12791.html'
		, 'https://sobooks.cc/books/12789.html'
		, 'https://sobooks.cc/books/12782.html'
		, 'https://sobooks.cc/books/12770.html'
		, 'https://sobooks.cc/books/12761.html'
		, 'https://sobooks.cc/books/12743.html'
		, 'https://sobooks.cc/books/12730.html'
		, 'https://sobooks.cc/books/12717.html'
		, 'https://sobooks.cc/books/12680.html'
		, 'https://sobooks.cc/books/12657.html'
		, 'https://sobooks.cc/books/12647.html'
		, 'https://sobooks.cc/books/12639.html'
		, 'https://sobooks.cc/books/12611.html'
		, 'https://sobooks.cc/books/12603.html'
		, 'https://sobooks.cc/books/12599.html'
		, 'https://sobooks.cc/books/12592.html'
		, 'https://sobooks.cc/books/12588.html'
		, 'https://sobooks.cc/books/12584.html'
		, 'https://sobooks.cc/books/12583.html'
		, 'https://sobooks.cc/books/12582.html'
		, 'https://sobooks.cc/books/12575.html'
		, 'https://sobooks.cc/books/12570.html'
		, 'https://sobooks.cc/books/12561.html'
		, 'https://sobooks.cc/books/12559.html'
		, 'https://sobooks.cc/books/12550.html'
		, 'https://sobooks.cc/books/13082.html'
		, 'https://sobooks.cc/books/13080.html'
		, 'https://sobooks.cc/books/13079.html'
		, 'https://sobooks.cc/books/13078.html'
		, 'https://sobooks.cc/books/13074.html'
		, 'https://sobooks.cc/books/13064.html'
		, 'https://sobooks.cc/books/13059.html'
		, 'https://sobooks.cc/books/13058.html'
		, 'https://sobooks.cc/books/13052.html'
		, 'https://sobooks.cc/books/13018.html'
		, 'https://sobooks.cc/books/13012.html'
		, 'https://sobooks.cc/books/12997.html'
		, 'https://sobooks.cc/books/12990.html'
		, 'https://sobooks.cc/books/13154.html'
		, 'https://sobooks.cc/books/13098.html'
		, 'https://sobooks.cc/books/12855.html'
		, 'https://sobooks.cc/books/12822.html'
		, 'https://sobooks.cc/books/12821.html'
		, 'https://sobooks.cc/books/12815.html'
		, 'https://sobooks.cc/books/12792.html'
		, 'https://sobooks.cc/books/12771.html'
		, 'https://sobooks.cc/books/12749.html'
		, 'https://sobooks.cc/books/12742.html'
		, 'https://sobooks.cc/books/12733.html'
		, 'https://sobooks.cc/books/12711.html'
		, 'https://sobooks.cc/books/12677.html'
		, 'https://sobooks.cc/books/12668.html'
		, 'https://sobooks.cc/books/12660.html'
		, 'https://sobooks.cc/books/12632.html'
		, 'https://sobooks.cc/books/12631.html'
		, 'https://sobooks.cc/books/12610.html'
		, 'https://sobooks.cc/books/12578.html'
		, 'https://sobooks.cc/books/12577.html'
		, 'https://sobooks.cc/books/12495.html'
		, 'https://sobooks.cc/books/12494.html'
		, 'https://sobooks.cc/books/12485.html'
		, 'https://sobooks.cc/books/12474.html'
		, 'https://sobooks.cc/books/12476.html'
		, 'https://sobooks.cc/books/12468.html'
		, 'https://sobooks.cc/books/12446.html'
		, 'https://sobooks.cc/books/13081.html'
		, 'https://sobooks.cc/books/13046.html'
		, 'https://sobooks.cc/books/13011.html'
		, 'https://sobooks.cc/books/13000.html'
		, 'https://sobooks.cc/books/12986.html'
		, 'https://sobooks.cc/books/13166.html'
		, 'https://sobooks.cc/books/13151.html'
		, 'https://sobooks.cc/books/13113.html'
		, 'https://sobooks.cc/books/13112.html'
		, 'https://sobooks.cc/books/12955.html'
		, 'https://sobooks.cc/books/12940.html'
		, 'https://sobooks.cc/books/12961.html'
		, 'https://sobooks.cc/books/12950.html'
		, 'https://sobooks.cc/books/12924.html'
		, 'https://sobooks.cc/books/12922.html'
		, 'https://sobooks.cc/books/12915.html'
		, 'https://sobooks.cc/books/12905.html'
		, 'https://sobooks.cc/books/12903.html'
		, 'https://sobooks.cc/books/12883.html'
		, 'https://sobooks.cc/books/12865.html'
		, 'https://sobooks.cc/books/12836.html'
		, 'https://sobooks.cc/books/12823.html'
		, 'https://sobooks.cc/books/12807.html'
		, 'https://sobooks.cc/books/12795.html'
		, 'https://sobooks.cc/books/12790.html'
		, 'https://sobooks.cc/books/12785.html'
		, 'https://sobooks.cc/books/12784.html'
		, 'https://sobooks.cc/books/12773.html'
		, 'https://sobooks.cc/books/12772.html'
		, 'https://sobooks.cc/books/12760.html'
		, 'https://sobooks.cc/books/12755.html'
		, 'https://sobooks.cc/books/12712.html'
		, 'https://sobooks.cc/books/12709.html'
		, 'https://sobooks.cc/books/12704.html'
		, 'https://sobooks.cc/books/12699.html'
		, 'https://sobooks.cc/books/12673.html'
		, 'https://sobooks.cc/books/12641.html'
		, 'https://sobooks.cc/books/12580.html'
		, 'https://sobooks.cc/books/12563.html'
		, 'https://sobooks.cc/books/12535.html'
		, 'https://sobooks.cc/books/12534.html'
		, 'https://sobooks.cc/books/12530.html'
		, 'https://sobooks.cc/books/12529.html'
		, 'https://sobooks.cc/books/12518.html'
		, 'https://sobooks.cc/books/12484.html'
		, 'https://sobooks.cc/books/12470.html'
		, 'https://sobooks.cc/books/13094.html'
		, 'https://sobooks.cc/books/13085.html'
		, 'https://sobooks.cc/books/13063.html'
		, 'https://sobooks.cc/books/13060.html'
		, 'https://sobooks.cc/books/13056.html'
		, 'https://sobooks.cc/books/12995.html'
		, 'https://sobooks.cc/books/12992.html'
		, 'https://sobooks.cc/books/13165.html'
		, 'https://sobooks.cc/books/13157.html'
		, 'https://sobooks.cc/books/13155.html'
		, 'https://sobooks.cc/books/13149.html'
		, 'https://sobooks.cc/books/13137.html'
		, 'https://sobooks.cc/books/13116.html'
		, 'https://sobooks.cc/books/12898.html'
		, 'https://sobooks.cc/books/12869.html'
		, 'https://sobooks.cc/books/12831.html'
		, 'https://sobooks.cc/books/12824.html'
		, 'https://sobooks.cc/books/12805.html'
		, 'https://sobooks.cc/books/12801.html'
		, 'https://sobooks.cc/books/12788.html'
		, 'https://sobooks.cc/books/12787.html'
		, 'https://sobooks.cc/books/12744.html'
		, 'https://sobooks.cc/books/12735.html'
		, 'https://sobooks.cc/books/12706.html'
		, 'https://sobooks.cc/books/12688.html'
		, 'https://sobooks.cc/books/12662.html'
		, 'https://sobooks.cc/books/12661.html'
		, 'https://sobooks.cc/books/12651.html'
		, 'https://sobooks.cc/books/12649.html'
		, 'https://sobooks.cc/books/12633.html'
		, 'https://sobooks.cc/books/12630.html'
		, 'https://sobooks.cc/books/12618.html'
		, 'https://sobooks.cc/books/12600.html'
		, 'https://sobooks.cc/books/12587.html'
		, 'https://sobooks.cc/books/12585.html'
		, 'https://sobooks.cc/books/12576.html'
		, 'https://sobooks.cc/books/12536.html'
		, 'https://sobooks.cc/books/12527.html'
		, 'https://sobooks.cc/books/12511.html'
		, 'https://sobooks.cc/books/12509.html'
		, 'https://sobooks.cc/books/12501.html'
		, 'https://sobooks.cc/books/12502.html'
		, 'https://sobooks.cc/books/12499.html'
		, 'https://sobooks.cc/books/12464.html'
		, 'https://sobooks.cc/books/12449.html'
		, 'https://sobooks.cc/books/12453.html'
		, 'https://sobooks.cc/books/12431.html'
		, 'https://sobooks.cc/books/12430.html'
		, 'https://sobooks.cc/books/13053.html'
		, 'https://sobooks.cc/books/13034.html'
		, 'https://sobooks.cc/books/13032.html'
		, 'https://sobooks.cc/books/12977.html'
		, 'https://sobooks.cc/books/13136.html'
		, 'https://sobooks.cc/books/13124.html'
		, 'https://sobooks.cc/books/13118.html'
		, 'https://sobooks.cc/books/13105.html'
		, 'https://sobooks.cc/books/13096.html'
	]

	SobooksCrawlerExecutor.new_range_tasks_by_detail_page_urls(detail_page_urls=urls)
	return

	SobooksCrawlerExecutor.find_duplicate_by(field='baiduUrl')
	return
	# Arguments
	if not isinstance(since_date, datetime):
		since_date = datetime.strptime(since_date, '%Y%m%d').date()

	# Fetch newer
	SobooksCrawlerExecutor.new_range_tasks_by_publish_time(since_date)
	return
	# def t():
	# Download newer
	with BaiduYunService() as svs:
		netdisk_folder_name = '08_book_newincome'
		from_date = datetime(since_date.year, since_date.month, since_date.day)  # datetime.strptime(since_date_str, '%Y%m%d')
		# to_date = datetime.strptime('2019-07-01', '%Y%m%d')
		# d = from_date.strftime('%Y-%m-%d')
		download_task_list = svs.query_tasks(
			criteria={'$and': [
				# {'editTime': {'$exists': 0}},
				{'publishTime': {'$gte': from_date}},
				# {'publishTime': {'$lte': to_date}},
			]}
		)

		for idx, t in enumerate(download_task_list):
			print('{:>3d}# 《{}》 {}'.format(idx + 1, t.title, t.baiduUrl))

		name_arr = [
			'脑髓地狱', '发现的乐趣', '名著名译丛书（第五辑）', '第一推动丛书·生命系列（套装共5册）', '跨市场交易策略（典藏版）', '亡者归来', '地狱书单', '茶叶大盗', '成化十四年', '人人都该懂的克隆技术', '罪与罚（名著名译丛书）', '仲夏夜之梦（莎士比亚戏剧中文版）', '巴黎美人', '晋江大神Priest经典作品合集（套装10册）', '国史论衡', '被偷走的人生', '技巧：如何用一年时间获得十年的经验', '晚清中国的光与影', '征途美国',
			'世界因何美妙而优雅地运行',
		]
		# Remove task
		print('Total count: {}'.format(len(download_task_list)))
		new_download_task_list = list()
		for task in download_task_list:
			# if task.title in name_arr:
			new_download_task_list.append(task)
		print('Total count: {}'.format(len(new_download_task_list)))
		svs.save_many(new_download_task_list, netdisk_folder_name=netdisk_folder_name)


@click.command()
@click.option('--action', '-a', type=str, default='fetch')
@click.option('--since-date', '-s', type=str, default=datetime.now().strftime('%Y%m%d'),
              help='Fetch the books which `publishTime` value since (and include) since_date value')
def command_dispatcher(action, since_date):
	since_date = datetime.strptime(since_date, '%Y%m%d')
	if 'fetch' == action.lower():
		fetch_from_sobooks_site(since_date)
	else:
		print('Invalid `action` value.')


if __name__ == '__main__':
	command_dispatcher()
